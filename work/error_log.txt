2025-07-23 15:04:28,918 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/modified_compareWithThread6.py", line 166, in run
    missing_df.insert(1 + idx, key, original_codes.map(lambda x: x.split(' + ')[idx]))
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 5171, in insert
    value, refs = self._sanitize_column(value)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 5266, in _sanitize_column
    com.require_length_match(value, self.index)
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/common.py", line 573, in require_length_match
    raise ValueError(
ValueError: Length of values (195225) does not match length of index (399997)

2025-07-23 15:04:29,177 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/modified_compareWithThread6.py", line 617, in on_compare_finished
    total_file1 = self.summary_data['total_file1']
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'total_file1'

2025-07-24 11:06:04,760 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 476, in closeEvent
    if hasattr(self, 'worker') and self.worker.isRunning():
                                   ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'isRunning'

2025-07-24 11:07:18,874 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 190, in run
    df1.set_index(self.primary_keys, inplace=True)
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 6122, in set_index
    raise KeyError(f"None of {missing} are in the columns")
KeyError: "None of ['成本中心编码'] are in the columns"

2025-07-24 11:26:12,627 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 495, in closeEvent
    if hasattr(self, 'worker') and self.worker.isRunning():
                                   ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'isRunning'

2025-07-24 11:28:35,755 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 285, in run
    if abs(val1_num - val2_num) > float(tail_diff):
                                  ^^^^^^^^^^^^^^^^
TypeError: float() argument must be a string or a real number, not 'NoneType'

2025-07-24 11:28:35,768 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 699, in on_compare_finished
    total_file1 = self.summary_data['total_file1']
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'total_file1'

2025-07-24 11:43:53,024 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '14ERM'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 341, in run
    source_dict = df1_common.loc[code].to_dict()
                  ~~~~~~~~~~~~~~^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4214, in _get_value
    series = self._get_item_cache(col)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4638, in _get_item_cache
    loc = self.columns.get_loc(item)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: '14ERM'

2025-07-24 11:43:53,029 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 706, in on_compare_finished
    total_file1 = self.summary_data['total_file1']
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'total_file1'

2025-07-24 12:31:57,664 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '14ERM'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 342, in run
    source_dict = df1_common.loc[code].to_dict()
                  ~~~~~~~~~~~~~~^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4214, in _get_value
    series = self._get_item_cache(col)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4638, in _get_item_cache
    loc = self.columns.get_loc(item)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: '14ERM'

2025-07-24 12:32:45,582 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '14ERM'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 342, in run
    source_dict = df1_common.loc[code].to_dict()
                  ~~~~~~~~~~~~~~^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4214, in _get_value
    series = self._get_item_cache(col)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4638, in _get_item_cache
    loc = self.columns.get_loc(item)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: '14ERM'

2025-07-24 13:04:49,873 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '14ERM'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 342, in run
    source_dict = df1_common.loc[code].to_dict()
                  ~~~~~~~~~~~~~~^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4214, in _get_value
    series = self._get_item_cache(col)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4638, in _get_item_cache
    loc = self.columns.get_loc(item)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: '14ERM'

2025-07-24 13:12:24,270 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '14ERM'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 342, in run
    source_dict = df1_common.loc[code].to_dict()
                  ~~~~~~~~~~~~~~^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4214, in _get_value
    series = self._get_item_cache(col)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4638, in _get_item_cache
    loc = self.columns.get_loc(item)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: '14ERM'

2025-07-24 13:12:24,276 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 707, in on_compare_finished
    total_file1 = self.summary_data['total_file1']
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'total_file1'

2025-07-24 13:15:10,364 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '14ERM'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 341, in run
    source_dict = df1_common.loc[code].to_dict()
                  ~~~~~~~~~~~~~~^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4214, in _get_value
    series = self._get_item_cache(col)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4638, in _get_item_cache
    loc = self.columns.get_loc(item)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: '14ERM'

2025-07-24 13:25:59,185 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '14ERM'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 341, in run
    source_dict = df1_common.loc[code].to_dict()
                  ~~~~~~~~~~~~~~^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4214, in _get_value
    series = self._get_item_cache(col)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4638, in _get_item_cache
    loc = self.columns.get_loc(item)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: '14ERM'

2025-07-24 13:49:57,919 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 725, in on_compare_finished
    total_file1 = self.summary_data['total_file1']
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'total_file1'

2025-07-24 13:50:13,170 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 526, in closeEvent
    if hasattr(self, 'worker_sheet1') and self.worker_sheet1.isRunning():
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'isRunning'

2025-07-24 13:57:56,539 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test111.py", line 526, in closeEvent
    if hasattr(self, 'worker_sheet1') and self.worker_sheet1.isRunning():
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'isRunning'

2025-07-24 16:02:19,708 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.1.py", line 527, in closeEvent
    if hasattr(self, 'worker_sheet1') and self.worker_sheet1.isRunning():
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'isRunning'

2025-07-24 16:24:12,822 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.2.py", line 517, in closeEvent
    if hasattr(self, 'worker') and self.worker.isRunning():
                                   ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'isRunning'

2025-07-24 16:31:48,022 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.2.py", line 790, in on_compare_finished
    total_file1 = self.summary_data['total_file1']
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'total_file1'

2025-07-24 16:32:03,537 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.2.py", line 592, in closeEvent
    if hasattr(self, 'worker_sheet1') and self.worker_sheet1.isRunning():
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'isRunning'

2025-07-24 17:19:36,758 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.3.py", line 638, in closeEvent
    if hasattr(self, 'worker') and self.worker.isRunning():
                                   ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'isRunning'

2025-07-25 19:48:07,808 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.3.py", line 679, in select_file1
    filename = os.path.basename(file)
    ^^^^
  File "_pydevd_bundle/pydevd_pep_669_tracing_cython.pyx", line 431, in _pydevd_bundle.pydevd_pep_669_tracing_cython.py_line_callback
  File "_pydevd_bundle/pydevd_pep_669_tracing_cython.pyx", line 425, in _pydevd_bundle.pydevd_pep_669_tracing_cython.py_line_callback
  File "/Applications/PyCharm CE.app/Contents/plugins/python-ce/helpers/pydev/pydevd.py", line 1196, in do_wait_suspend
    self._do_wait_suspend(thread, frame, event, arg, suspend_type, from_this_thread)
  File "/Applications/PyCharm CE.app/Contents/plugins/python-ce/helpers/pydev/pydevd.py", line 1211, in _do_wait_suspend
    time.sleep(0.01)
KeyboardInterrupt

2025-08-04 20:45:09,623 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 224, in _get_value
    return float(part)
           ^^^^^^^^^^^
ValueError: could not convert string to float: '使用期间/12'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 184, in calculate_field
    right = self._get_value(df, parts[1])
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 226, in _get_value
    raise Exception(f"无法解析值：{part}（不是字段也不是数值）")
Exception: 无法解析值：使用期间/12（不是字段也不是数值）

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 263, in run
    df2[table2_field] = self.calculate_field(df2, calc_rule)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 213, in calculate_field
    raise Exception(f"计算规则执行失败（{calc_rule}）：{str(e)}")
Exception: 计算规则执行失败（使用年限+使用期间/12）：无法解析值：使用期间/12（不是字段也不是数值）

2025-08-04 20:59:20,901 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 192, in calculate_field
    result = df_filled.eval(calc_rule)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4949, in eval
    return _eval(expr, inplace=inplace, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/eval.py", line 336, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 805, in __init__
    self.terms = self.parse()
                 ^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 824, in parse
    return self._visitor.visit(self.expr)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 411, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 417, in visit_Module
    return self.visit(expr, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 411, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 420, in visit_Expr
    return self.visit(node.value, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 411, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 531, in visit_BinOp
    op, op_class, left, right = self._maybe_transform_eq_ne(node)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 453, in _maybe_transform_eq_ne
    right = self.visit(node.right, side="right")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 411, in visit
    return visitor(node, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 533, in visit_BinOp
    return self._maybe_evaluate_binop(op, op_class, left, right)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/computation/expr.py", line 503, in _maybe_evaluate_binop
    raise TypeError(
TypeError: unsupported operand type(s) for /: 'object' and '<class 'int'>'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 247, in run
    df2[table2_field] = self.calculate_field(df2, calc_rule)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 197, in calculate_field
    raise Exception(f"计算规则执行失败（{calc_rule}）：{str(e)}")
Exception: 计算规则执行失败（使用年限+使用期间/12）：unsupported operand type(s) for /: 'object' and '<class 'int'>'

2025-08-04 21:02:39,215 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 255, in run
    raise Exception(f"字段计算结果全为空：{table2_field} = {calc_rule}")
Exception: 字段计算结果全为空：公司代码+资产编码 = 公司代码+资产编码

2025-08-04 21:03:26,334 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 255, in run
    raise Exception(f"字段计算结果全为空：{table2_field} = {calc_rule}")
Exception: 字段计算结果全为空：公司代码+资产编码 = 公司代码+资产编码

2025-08-04 21:05:24,074 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 255, in run
    raise Exception(f"字段计算结果全为空：{table2_field} = {calc_rule}")
Exception: 字段计算结果全为空：公司代码+资产编码 = 公司代码+资产编码

2025-08-04 21:13:54,498 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 170, in calculate_field
    raise Exception(f"字段不存在：{field}")
Exception: 字段不存在：WBS编码

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 257, in run
    df2[table2_field] = self.calculate_field(df2, calc_rule, rule["data_type"])
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 207, in calculate_field
    raise Exception(f"计算规则执行失败（{calc_rule}）：{str(e)}")
Exception: 计算规则执行失败（WBS编码[:12]）：字段不存在：WBS编码

2025-08-04 21:14:40,640 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 170, in calculate_field
    raise Exception(f"字段不存在：{field}")
Exception: 字段不存在：WBS编码

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 257, in run
    df2[table2_field] = self.calculate_field(df2, calc_rule, rule["data_type"])
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 207, in calculate_field
    raise Exception(f"计算规则执行失败（{calc_rule}）：{str(e)}")
Exception: 计算规则执行失败（WBS编码[:12]）：字段不存在：WBS编码

2025-08-04 21:16:11,929 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 170, in calculate_field
    raise Exception(f"字段不存在：{field}")
Exception: 字段不存在：WBS编码

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 257, in run
    df2[table2_field] = self.calculate_field(df2, calc_rule, rule["data_type"])
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 207, in calculate_field
    raise Exception(f"计算规则执行失败（{calc_rule}）：{str(e)}")
Exception: 计算规则执行失败（WBS编码[:12]）：字段不存在：WBS编码

2025-08-04 21:21:53,889 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 291, in run
    df2 = df2[all_needed_columns]
          ~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['累计折旧'] not in index"

2025-08-04 21:36:11,232 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 291, in run
    df2 = df2[all_needed_columns]
          ~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['累计折旧'] not in index"

2025-08-04 21:49:50,135 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 367, in run
    df2_empty_keys = df2[pd.isna(df2[pk]) | (df2[pk].astype(str).str.strip() == '')]
                                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'str'. Did you mean: 'std'?

2025-08-04 21:52:17,770 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 361, in run
    df2_empty_keys = df2[pd.isna(df2[pk]) | (df2[pk].astype(str).str.strip() == '')]
                                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'str'. Did you mean: 'std'?

2025-08-04 21:55:21,323 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 363, in run
    df1_empty_keys = df1[pd.isna(df1[pk]) | (df1[pk].iloc[:, 0].astype(str).str.strip() == '')]
                                             ~~~~~~~~~~~~^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1184, in __getitem__
    return self._getitem_tuple(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1690, in _getitem_tuple
    tup = self._validate_tuple_indexer(tup)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 962, in _validate_tuple_indexer
    key = self._validate_key_length(key)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1001, in _validate_key_length
    raise IndexingError("Too many indexers")
pandas.errors.IndexingError: Too many indexers

2025-08-04 22:06:01,371 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 447, in run
    missing_in_file2 = df1.index.difference(df2.index)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3661, in difference
    result = self._difference(other, sort=sort)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3670, in _difference
    the_diff = this[other.get_indexer_for(this) == -1]
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6182, in get_indexer_for
    return self.get_indexer(target)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3953, in get_indexer
    return self._get_indexer(target, method, limit, tolerance)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3974, in _get_indexer
    tgt_values = engine._extract_level_codes(  # type: ignore[union-attr]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 734, in pandas._libs.index.BaseMultiIndexCodesEngine._extract_level_codes
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/multi.py", line 2579, in _recode_for_new_levels
    raise AssertionError(
AssertionError: Length of new_levels (2) must be <= self.nlevels (1)

2025-08-04 22:09:34,665 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 340, in run
    df2_empty_keys = df2[pd.isna(df2[pk]) | (df2[pk].astype(str).str.strip() == '')]
                                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'str'. Did you mean: 'std'?

2025-08-04 22:13:53,416 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 344, in run
    pk_series = df2[pk].astype(str).str.strip()
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'str'. Did you mean: 'std'?

2025-08-04 22:17:45,014 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5.py", line 396, in run
    missing_in_file2 = df1.index.difference(df2.index)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3661, in difference
    result = self._difference(other, sort=sort)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3670, in _difference
    the_diff = this[other.get_indexer_for(this) == -1]
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6182, in get_indexer_for
    return self.get_indexer(target)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3953, in get_indexer
    return self._get_indexer(target, method, limit, tolerance)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3974, in _get_indexer
    tgt_values = engine._extract_level_codes(  # type: ignore[union-attr]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 734, in pandas._libs.index.BaseMultiIndexCodesEngine._extract_level_codes
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/multi.py", line 2579, in _recode_for_new_levels
    raise AssertionError(
AssertionError: Length of new_levels (2) must be <= self.nlevels (1)

2025-08-04 23:00:22,883 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 449, in run
    key_series1 = build_primary_key(df1, self.rules, is_table1=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 145, in build_primary_key
    raise ValueError(f"主键列 {field} 在数据中不存在")
ValueError: 主键列 原资产编码 在数据中不存在

2025-08-04 23:01:44,435 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 449, in run
    key_series1 = build_primary_key(df1, self.rules, is_table1=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 145, in build_primary_key
    raise ValueError(f"主键列 {field} 在数据中不存在")
ValueError: 主键列 原资产编码 在数据中不存在

2025-08-04 23:03:17,844 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 449, in run
    key_series1 = build_primary_key(df1, self.rules, is_table1=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 145, in build_primary_key
    raise ValueError(f"主键列 {field} 在数据中不存在")
ValueError: 主键列 原资产编码 在数据中不存在

2025-08-04 23:07:35,708 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 449, in run
    key_series1 = build_primary_key(df1, self.rules, is_table1=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 145, in build_primary_key
    raise ValueError(f"主键列 {field} 在数据中不存在")
ValueError: 主键列 原资产编码 在数据中不存在

2025-08-04 23:09:36,173 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 136, in build_primary_key
    raise ValueError(f"列 {col} 在文件中不存在，无法拼接主键")
ValueError: 列 公司代码 在文件中不存在，无法拼接主键

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 450, in run
    key_series2 = build_primary_key(df2_original, self.rules, is_table1=False)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 142, in build_primary_key
    raise ValueError(f"主键拼接失败：{e}")
ValueError: 主键拼接失败：列 公司代码 在文件中不存在，无法拼接主键

2025-08-04 23:54:34,451 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/ExcelComparerV2.5_fixed.py", line 456, in run
    missing_in_file2 = df1.pk.difference(df2.pk)
                       ^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'pk'

2025-08-05 09:06:50,118 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 360, in run
    df2_empty_keys = df2[pd.isna(df2[pk]) | (df2[pk].astype(str).str.strip() == '')]
                                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'str'. Did you mean: 'std'?

2025-08-05 09:15:54,088 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 373, in run
    df2_empty_keys = df2[pd.isna(df2[pk]) | (df2[pk].astype(str).str.strip() == '')]
                                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'str'. Did you mean: 'std'?

2025-08-05 09:18:16,670 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 375, in run
    df2_empty_keys = df2[pd.isna(df2[pk]) | (df2[pk].astype(str).str.strip() == '')]
                                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'str'. Did you mean: 'std'?

2025-08-05 09:24:17,511 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 375, in run
    df2_empty_keys = df2[pd.isna(df2[pk]) | (df2[pk].astype(str).astype(str).str.strip() == '')]
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'str'. Did you mean: 'std'?

2025-08-05 09:27:15,882 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 384, in run
    df2_empty_keys = df2[pd.isna(df2[pk]) | (df2[pk].astype(str).astype(str).str.strip() == '')]
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'str'. Did you mean: 'std'?

2025-08-05 09:28:59,377 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 384, in run
    df2_empty_keys = df2[pd.isna(df2[pk]) | (df2[pk].astype(str).astype(str).str.strip() == '')]
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'str'. Did you mean: 'std'?

2025-08-05 09:57:01,179 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 325, in run
    self.process_primary_keys(df2)
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'CompareWorker' object has no attribute 'process_primary_keys'

2025-08-05 10:46:26,525 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/work/test.py", line 289, in run
    df2.drop(columns=[field1], inplace=True)
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 5581, in drop
    return super().drop(
           ^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 4788, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 4859, in _drop_axis
    raise KeyError(f"{labels} not found in axis")
KeyError: "['资产状态'] not found in axis"

2025-08-05 11:50:16,724 - ERROR - Traceback (most recent call last):
  File "/Users/liuzongchen/PycharmProjects/pythonProject/jiangsu/test.py", line 328, in run
    df2 = df2[all_needed_columns]
          ~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/liuzongchen/PycharmProjects/pythonProject/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['项目名称'] not in index"

